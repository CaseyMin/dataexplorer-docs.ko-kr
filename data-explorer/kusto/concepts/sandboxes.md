---
title: 샌드박스-Azure 데이터 탐색기
description: 이 문서에서는 Azure 데이터 탐색기의 샌드박스에 대해 설명 합니다.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: rkarlin
ms.service: data-explorer
ms.topic: reference
ms.date: 03/30/2020
ms.openlocfilehash: 7dbbd4b94169e6b1e23547c7a6b9ed94cf5e70ca
ms.sourcegitcommit: be1bbd62040ef83c08e800215443ffee21cb4219
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/10/2020
ms.locfileid: "84664964"
---
# <a name="sandboxes"></a>샌드박스

Kusto의 데이터 엔진 서비스는 보안 격리가 필요한 특정 흐름에 대해 샌드박스를 실행할 수 있습니다.
이러한 흐름의 예로는 [Python 플러그 인](../query/pythonplugin.md) 또는 [R 플러그 인](../query/rplugin.md)을 사용 하 여 실행 되는 사용자 정의 스크립트가 있습니다.

이러한 샌드박스를 실행 하기 위해 Kusto는 Microsoft의 [Drawbridge](https://www.microsoft.com/research/project/drawbridge/) 프로젝트의 진화 된 버전을 사용 합니다. 이 솔루션은 다른 Microsoft 서비스에서 다중 테 넌 트 환경에서 사용자 정의 개체를 실행 하는 데 사용 됩니다.

샌드박스에서 실행 되는 흐름은 격리 되지 않습니다. 또한 로컬 (데이터에 근접)입니다. 이는 원격 호출에 추가 대기 시간이 추가 되지 않았음을 의미 합니다.

## <a name="prerequisites"></a>필수 구성 요소

* 데이터 엔진 되어서는 안됩니다에서 [디스크 암호화](../../security.md#data-encryption) 를 사용 하도록 설정 했습니다.
  * 나중에 side-by-side로 실행 되는 두 기능에 대 한 지원이 필요 합니다.
* 샌드박스를 실행 하는 데 필요한 패키지 (이미지)는 각 데이터 엔진의 노드에 배포 되 고 전용 SSD 공간이 있어야 실행할 수 있습니다.
  * 예상 크기는 20GB입니다. 즉, D14_v2 VM의 SSD 용량 (예 0.7: L16_v1 VM의 SSD 용량)은 대략 2.5%입니다.
  * 이는 클러스터의 데이터 용량에 영향을 주며 클러스터의 [비용](https://azure.microsoft.com/pricing/details/data-explorer) 에 영향을 줄 수 있습니다.

## <a name="runtime"></a>런타임

* 샌드 박싱된 쿼리 연산자는 실행을 위해 하나 이상의 샌드박스를 사용할 수 있습니다.
  * 샌드박스는 단일 실행에만 사용 되 고, 여러 실행에서 공유 되지 않으며, 실행이 완료 되 면 삭제 됩니다.
  * 샌드박스에서 실행을 위해 처음으로 쿼리를 실행 해야 하는 경우에는 샌드박스에서 런타임에 초기화가 지연 됩니다.
    * 즉, 노드에서 샌드박스를 사용 하는 플러그 인을 처음 실행 하면 짧은 준비 기간이 포함 됩니다.
  * 예를 들어 서비스 업그레이드의 일부로 노드를 다시 시작 하는 경우 해당 노드를 실행 하는 모든 샌드박스는 삭제 됩니다.
* 각 노드는 들어오는 요청을 실행할 준비가 된 미리 정의 된 수의 샌드박스를 유지 관리 합니다.
  * 샌드박스를 사용 하면 새 샌드박스를 자동으로 바꿀 수 있습니다.
* 쿼리 연산자를 제공 하는 데 사용할 수 있는 미리 할당 된 샌드박스에서 없는 경우 새 샌드박스를 사용할 수 있을 때까지 제한 됩니다. 자세한 내용은 [오류](#errors)를 참조 하세요. 새 샌드박스 할당은 데이터 노드의 SKU 및 사용 가능한 리소스에 따라 sandbox 당 최대 10-15 초까지 걸릴 수 있습니다.

## <a name="limitations"></a>제한 사항

모든 종류의 샌드박스에 대해 클러스터 수준 [샌드박스 정책을](../management/sandboxpolicy.md)사용 하 여 몇 가지 제한 사항을 제어할 수 있습니다.

* **노드당 샌드박스 수:** 노드당 샌드박스 수가 제한 됩니다.
  * 사용할 수 있는 샌드박스가 없을 때 발생 하는 요청은 제한 됩니다.
* **네트워크:** 샌드박스는 VM (가상 머신) 또는 외부의 리소스와 상호 작용할 수 없습니다.
  * 샌드박스는 다른 샌드박스에 상호 작용할 수 없습니다.
* **CPU:** 샌드박스에서 호스트 프로세서를 소비할 수 있는 최대 CPU 비율은 제한 됩니다 (기본값은 `50%` ).
  * 제한에 도달 하면 샌드박스의 CPU 사용량이 제한 되지만 실행은 계속 됩니다.
* **메모리:** 샌드박스에서 호스트의 RAM을 사용할 수 있는 최대 RAM 크기는 제한 됩니다 (기본값은 `20GB` ).
  * 한도에 도달 하면 샌드박스가 종료 되 고 쿼리 실행 오류가 발생 합니다.
* **디스크:** 샌드박스에는 고유 하 고 독립적인 디렉터리가 연결 되어 있습니다. 호스트의 파일 시스템에 액세스할 수 없습니다.
  * 고유한 폴더를 사용 하면 해당 sandbox의 형식과 일치 하는 이미지/패키지에 액세스할 수 있습니다. 예를 들어 사용자 지정할 수 없는 Python 또는 R 패키지를 사용할 수 있습니다.
* **자식 프로세스:** 샌드박스는 자식 프로세스를 생성 하지 못하도록 차단 됩니다.

> [!NOTE]
> 샌드박스에서 사용 되는 리소스는 요청의 일부로 처리 되는 데이터의 크기 뿐만 아니라 샌드박스에서 실행 되는 논리와이 클래스에서 사용 되는 라이브러리 구현에 따라 달라 집니다.
> 예를 들어 `python` 및 `r` 플러그 인의 경우 후자는 사용자 제공 스크립트와 런타임에 사용 하는 Python 또는 R 라이브러리를 의미 합니다.

## <a name="errors"></a>오류

|코드                      |메시지                                                                                        |가능한 원인                                                                                                    |
|--------------------------|-----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
|E_SB_QUERY_THROTTLED_ERROR|제한으로 인해 샌드 박싱된 쿼리가 중단 되었습니다. 일부 백오프 성공 후 다시 시도 하 고 있습니다.   |대상 노드에 사용 가능한 샌드박스에서 없습니다. 몇 초 후에 새 샌드박스를 사용할 수 있게 됩니다.     |
|E_SB_QUERY_THROTTLED_ERROR|' {Kind} ' 종류의 샌드박스는 아직 초기화 되지 않았습니다.                       |샌드박스 정책이 최근에 변경 되었습니다. 새 샌드박스에 엑세스 새 정책을 몇 초 안에 사용할 수 있게 됩니다.           |
